{% extends 'core/base.html' %}
{% load static %}
{% block css %}

{% endblock %}
{% block contenido %}
<div class="hero-wrap hero-bread" style="background-image: url('images/bg_6.jpg');">
	<div class="container">
		<div class="row no-gutters slider-text align-items-center justify-content-center">
			<div class="col-md-9 ftco-animate text-center">
				<p class="breadcrumbs"><span class="mr-2"><a href="index.html">Inicio</a></span> <span>Carro</span></p>
				<h1 class="mb-0 bread">Mi Lista de deseos</h1>
			</div>
		</div>
	</div>
</div>

<section class="ftco-section ftco-cart">
	<div class="container">
		<div class="row">
			<div class="col-md-12 ftco-animate">
				<div class="cart-list">
					<table class="table">
						<thead class="thead-primary">
							<tr class="text-center">
								<th>&nbsp;</th>
								<th>&nbsp;</th>
								<th>Producto</th>
								<th>Precio</th>
								<th>Cantidad</th>
								<th>Total</th>
							</tr>
						</thead>

						{% for carrito in carrito %}
						<tbody>
							<tr class="text-center">
								<td class="product-remove"><a href="#"><span class="ion-ios-close"></span></a></td>

								<td class="image-prod">
									{% if item_carrito.producto.foto %}
									<img src="{{ carrito.producto.foto.url }}" class="img-fluid" width="100"
										height="100">
									{% else %}
									<img src="{% static 'core/images/bebedero.jpg'%}" class="img-fluid" width="100"
										height="100">
									{% endif %}
								</td>

								<td class="product-name">
									<h3>{{ carrito.producto.nombre }}</h3>
									<p>Far far away, behind the word mountains, far from the countries</p>
								</td>

								<td class="price">${{ carrito.producto.precio }}</td>

								<td class="quantity">
									<div class="col">
										<a href="{% url 'Sub' carrito.producto_id %}"
											class="badge btn btn-dark badge-dark">-</a>
									</div>
									{{ carrito.cantidad }}
									<div class="col">
										<a href="{% url 'Add' carrito.producto_id %}"
											class="badge btn btn-dark badge-dark" style="margin-right: 30px;">+</a>
									</div>
								</td>

								<td class="total">${{ precio_total }}</td>
							</tr><!-- END TR-->
						{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="row justify-content-start">
			<div class="col col-lg-5 col-md-6 mt-5 cart-wrap ftco-animate">
				<div class="cart-total mb-3">
					<h3>Total</h3>
					<p class="d-flex">
						<span>Subtotal</span>
						<span>${{ precio_total }}</span>
					</p>
					<p class="d-flex">
						<span>Delivery</span>
						<span>$0.00</span>
					</p>
					<p class="d-flex">
						<span>Descuento</span>
						<span>$3.00</span>
					</p>
					<hr>
					<p class="d-flex total-price">
						<span>Total</span>
						<span>${{ precio_total }}</span>
					</p>
				</div>
				<p>
				<div id="btnPaypal">Pagar</div>
				</p>
			</div>


		</div>
	</div>

</section>





{% endblock %}

{% block js %}

<script src="http://www.paypalobjects.com/api/checkout.js"></script>
<script>
	paypal.Button.render({
		env: 'sandbox',
		client: {
			sandbox: 'AeTyLGm5wUyTDIaQiKNqwnt0GVpM6RDJnfOsmWv0k45BsH5KUeaWssRnJZViuBGKJqJQIMIt626Xk6Eh', //USAR ID DEL PROYECTO NUESTRO

			production: 'demo_production_client_id'
		},
		locale: 'es_CL',
		style: {
			size: 'large', // small, medium, large
			color: 'gold', // gold, black
			shape: 'rect' // pill , rect
		},
		commit: true,
		payment: function (data, actions) {
			return actions.payment.create({
				transactions: [{
					amount: {
						total: '1.00',
						currency: 'USD'
					}
				}]
			});
		},
		onAuthorize: function (data, actions) {
			return actions.payment.execute().then(function () {
				// LOGICA DESPUES DEL PAGO
				Swal.fire({
					title: 'Pago Exitoso',
					text: 'Pago realizado correctamente!',
					icon: 'success',
					showCancelButton: false,
					confirmButtonColor: '#3085d6',
					cancelButtonColor: '#d33',
					confirmButtonText: 'Aceptar'
				});
			})
		},
		onCancel(data) {
			Swal.fire({
				title: 'Pago Cancelado',
				text: 'El pago ha sido cancelado!',
				icon: 'error',
				showCancelButton: false,
				confirmButtonColor: '#3085d6',
				cancelButtonColor: '#d33',
				confirmButtonText: 'Aceptar'
			});
		},
		onError(err) {
			Swal.fire({
				title: 'Error de pago',
				text: 'Ha ocurrido un error con el pago!',
				icon: 'error',
				showCancelButton: false,
				confirmButtonColor: '#3085d6',
				cancelButtonColor: '#d33',
				confirmButtonText: 'Aceptar'
			});
		}

	}, '#btnPaypal');
</script>



{% endblock %}